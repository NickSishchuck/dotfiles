#!/bin/bash
set -e

SCRIPT_DIR=$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" &>/dev/null && pwd)
source "$SCRIPT_DIR/lib/helpers.sh"
source "$SCRIPT_DIR/lib/backup.sh"
DOTFILES_DIR="$HOME/.local/share/dotfiles"

# Your repo URL
NVIM_REPO="https://github.com/NickSishchuck/nvim-config.git"

if [ -d "$HOME/.config/nvim" ] || [ -L "$HOME/.config/nvim" ]; then
  log_info "Existing nvim config found, backing up..."
  if [ -e "$HOME/.config/nvim" ]; then
    backup_file "$HOME/.config/nvim" || {
      log_error "Failed to backup nvim config"
      exit 1
    }
  fi
  remove_path "$HOME/.config/nvim"
fi

log_info "Cloning your nvim config..."
# Clone directly into ~/.config/nvim (target directory as second argument)
if ! git clone "$NVIM_REPO" "$HOME/.config/nvim"; then
  log_error "Failed to clone nvim config"
  exit 1
fi

log_success "Nvim config installed!"
